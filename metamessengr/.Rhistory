grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
data = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
if(!is.null(num)) {
data = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE) %>%
dplyr::slice(n = 1:num, order_by=freq)
}
data
}
test_me <- top_words_test(me_text, num=3)
test_me
class(num)
num=3
class(num)
test_me <- top_words_test(me_text, num=num)
test_me
top_words_test <- function(data, num = NULL) {
num <- value <- content <- sender <- words <- used <- NULL
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
data = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
if(!is.null(num)) {
data = data %>%
dplyr::slice(n = 1:num, order_by=freq)
}
data
}
test_me <- top_words_test(me_text, num=num)
test_me
test_me %>% slice(1:3)
top_words_test <- function(data, num = NULL) {
num <- value <- content <- sender <- words <- used <- NULL
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
data = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
if(!is.null(num)) {
data = data %>%
dplyr::slice(1:num, order_by=freq)
}
data
}
test_me <- top_words_test(me_text, num=3)
top_words_test <- function(data, num = NULL) {
num <- value <- content <- sender <- words <- used <- NULL
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
data = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
if(!base::is.null(num)) {
data = data %>%
dplyr::slice(1:num)
}
data
}
test_me <- top_words_test(me_text, num=3)
test_me
is.numeric
top_words_test <- function(data, num = NULL) {
num <- value <- content <- sender <- words <- used <- NULL
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
data = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
if(base::is.numeric(num)) {
data = data %>%
dplyr::slice(1:num)
}
data
}
test_me <- top_words_test(me_text, num=3)
top_words_test <- function(data, num = 5) {
num <- value <- content <- sender <- words <- used <- NULL
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
data = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
if(base::is.numeric(num)) {
data = data %>%
dplyr::slice(1:num)
}
data
}
test_me <- top_words_test(me_text)
test_me
test_me <- top_words_test(me_text, num=as.numeric(5))
test_me
?slice_max
top_words_test <- function(data, num = 5) {
num <- value <- content <- sender <- words <- used <- NULL
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
data = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
if(base::is.numeric(num)) {
data = data %>%
dplyr::slice_max(num)
}
data
}
test_me <- top_words_test(me_text)
test_me
document()
top_words <- function(data, num = 5) {
num <- value <- content <- sender <- words <- used <- NULL
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
if(base::is.numeric(num)) {
df = df %>%
dplyr::slice_max(num)
}
df
}
top_words(me_text)
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = me_text %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
df
if(base::is.numeric(num)) {
df = df %>%
dplyr::slice_max(num)
}
df
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = me_text %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
if(base::is.numeric(num)) {
df = df %>%
dplyr::slice(1:num)
}
df
top_words <- function(data, num = 5) {
num <- value <- content <- sender <- words <- used <- NULL
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
ifelse(!is.null(num),
df,
df = df %>%
dplyr::slice(1:num)
)
df
}
top_words <- function(data, num = NULL) {
num <- value <- content <- sender <- words <- used <- NULL
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
ifelse(!is.null(num),
df,
df = df %>%
dplyr::slice(1:num)
)
df
}
top_words(me_text, num = 5)
top_words <- function(data, num = NULL) {
num <- value <- content <- sender <- words <- used <- NULL
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
df = ifelse(!is.null(num),
df,
df %>%
dplyr::slice(1:num)
)
df
}
top_words(me_text, num = 5)
top_words <- function(data, num = NULL) {
num <- value <- content <- sender <- words <- used <- NULL
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
ifelse(!is.null(num),
df,
df %>%
dplyr::slice(1:num)
)
df
}
top_words(me_text, num = 5)
top_words <- function(data, num = NULL) {
num <- value <- content <- sender <- words <- used <- NULL
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
ifelse(is.null(num), df,
df %>%
dplyr::slice(1:num)
)
df
}
top_words(me_text, num = 5)
top_words <- function(data, num = NULL) {
num <- value <- content <- sender <- words <- used <- NULL
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
df = ifelse(is.null(num), df,
df %>%
dplyr::slice(1:num)
)
df
}
top_words(me_text, num = 5)
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = me_text %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
df
df = ifelse(is.null(num), df,
df %>%
dplyr::slice(1:num)
)
df
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = me_text %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
df
df = ifelse(is.null(num), df,
df %>%
dplyr::slice(1:num)) %>%
dplyr::group_by(sender)
df
df = ifelse(is.null(num), df,
df %>%
dplyr::group_by(sender) %>%
dplyr::slice(1:num))
df
top_words <- function(data, num = NULL) {
num <- value <- content <- sender <- words <- used <- NULL
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
if(class(num)=="numeric") {
df = df %>%
dplyr::ungroup() %>%
dplyr::group_by(sender) %>%
dplyr::slice(1:num)
}
df
}
top_words(me_text, num = 5)
document()
rm(list = c("top_words"))
document()
check()
document()
