dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
ifelse(!is.null(num),
df,
df = df %>%
dplyr::slice(1:num)
)
df
}
top_words(me_text, num = 5)
top_words <- function(data, num = NULL) {
num <- value <- content <- sender <- words <- used <- NULL
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
df = ifelse(!is.null(num),
df,
df %>%
dplyr::slice(1:num)
)
df
}
top_words(me_text, num = 5)
top_words <- function(data, num = NULL) {
num <- value <- content <- sender <- words <- used <- NULL
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
ifelse(!is.null(num),
df,
df %>%
dplyr::slice(1:num)
)
df
}
top_words(me_text, num = 5)
top_words <- function(data, num = NULL) {
num <- value <- content <- sender <- words <- used <- NULL
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
ifelse(is.null(num), df,
df %>%
dplyr::slice(1:num)
)
df
}
top_words(me_text, num = 5)
top_words <- function(data, num = NULL) {
num <- value <- content <- sender <- words <- used <- NULL
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
df = ifelse(is.null(num), df,
df %>%
dplyr::slice(1:num)
)
df
}
top_words(me_text, num = 5)
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = me_text %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
df
df = ifelse(is.null(num), df,
df %>%
dplyr::slice(1:num)
)
df
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = me_text %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
df
df = ifelse(is.null(num), df,
df %>%
dplyr::slice(1:num)) %>%
dplyr::group_by(sender)
df
df = ifelse(is.null(num), df,
df %>%
dplyr::group_by(sender) %>%
dplyr::slice(1:num))
df
top_words <- function(data, num = NULL) {
num <- value <- content <- sender <- words <- used <- NULL
grady_augmented <- dplyr::as_tibble(metamessengr::grady_augmented)
grady_augmented=dplyr::rename(grady_augmented, words=value)
data = data %>%
tidytext::unnest_tokens(input = content,
output = "words",
token = "words") %>%
dplyr::semi_join(grady_augmented) %>%
dplyr::group_by(sender, words) %>%
dplyr::summarise(used = dplyr::n()) %>%
dplyr::mutate(total = base::sum(used)) %>%
dplyr::mutate(freq = used/total) %>%
dplyr::ungroup() %>%
dplyr::mutate(sender = base::ifelse(sender=="",NA,sender)) %>%
stats::na.omit()
df = data %>%
dplyr::group_by(sender) %>%
dplyr::arrange(dplyr::desc(freq), .by_group = TRUE)
if(class(num)=="numeric") {
df = df %>%
dplyr::ungroup() %>%
dplyr::group_by(sender) %>%
dplyr::slice(1:num)
}
df
}
top_words(me_text, num = 5)
document()
rm(list = c("top_words"))
document()
check()
document()
document()
library(devtools)
document()
document()
document()
document
document()
document()
document()
document()
document()
document()
document()
check()
check()
document()
install()
library(metamessengr)
mess_selection("C:/Users/meowy/OneDrive/Desktop/fbm_data_subset")
me <- mess_selection("C:/Users/meowy/OneDrive/Desktop/fbm_data_subset")
me
me_clean <- clean_mess_all(me)
me_clean
document()
me_sent <- mess_cut_off(me_clean, "2020-01-01")
me_sent
me_sent <- mess_sentiment(me_sent)
me_sent
t_mess(me_sent)
summary(me_sent$event)
table(me_sent$event)
min(me_sent$date)
plot_mess(me_sent)
?vars
?ggplot2::fascet_wrap
?ggplot2::facet_wrap
sender_sum(me_sent)
group_sum
group_sum(me_sent)
group_sum(me_clean)
top_words(me_sent)
top_words(me_clean)
mess_cut_off <-  function(data, time = "2020-03-01") {
data %>%
dplyr::mutate(event = base::ifelse(date < base::as.Date(time, origin = "1970-01-01"),
"pre", #if before cutoff time
"post")) #if before cutoff time
}
me_cut <- mess_cut_off(me_clean)
me_cut
min(me_cut$date)
unique(me_cut$event)
setwd("C:/Users/meowy/OneDrive/Documents/School stuff/Yale/BIS 620/fb_mess_final_proj/metamessengr")
document()
library(devtoll)
library(devtools)
document()
document()
check()
me
install()
install()
library(metamessengr)
mess_selection("C:/Users/meowy/OneDrive/Desktop/fbm_data_subset")
me <- mess_selection("C:/Users/meowy/OneDrive/Desktop/fbm_data_subset")
me <- mess_selection("C:/Users/meowy/OneDrive/Desktop/fbm_data_subset")
me
library(devtools)
install
install()
library(metamessengr)
me <- mess_selection("C:/Users/meowy/OneDrive/Desktop/fbm_data_subset")
me
getwd()
me_clean <- clean_mess_all(me)
me_clean
unique(me_clean$convo)
sender_sum(me_clean)
group_sum(me_clean)
group_sum <- function(data) {
sent_to <- NULL
data %>%
dplyr::group_by(sent_to) %>%
dplyr::summarise(count = dplyr::n(),
length = base::sum(length, na.rm = T))%>%
dplyr::arrange(dplyr::desc(count))
}
group_sum(me_clean)
top_words(me_clean)
top_words(me_clean) %>%
filter(sender = "Alexander*")
top_words(me_clean)
top_words(me_clean) %>%
filter(sender == "Alexander James Robertson")
top_words(me_clean) %>%
filter("sender" == "Alexander James Robertson")
me_cut <- mess_cut_off(me_clean)
me_cut
unique(me_cut$event)
me_clean %>%
dplyr::mutate(event = base::ifelse(date < base::as.Date(time, origin = "1970-01-01"),
"pre", #if before cutoff time
"post")) #if before cutoff time
test <- me_clean %>%
dplyr::mutate(event = base::ifelse(date < base::as.Date(time, origin = "1970-01-01"),
"pre", #if before cutoff time
"post")) #if before cutoff time
unique(test$event)
mess_cut_off <-  function(data, time = "2020-03-01") {
data %>%
dplyr::mutate(event = dplyr::ifelse(date < base::as.Date(time, origin = "1970-01-01"),
"pre", #if before cutoff time
"post")) #if before cutoff time
}
test <- me_clean %>%
dplyr::mutate(event = base::ifelse(date < base::as.Date(time, origin = "1970-01-01"),
"pre", #if before cutoff time
"post")) #if before cutoff time
me_cut <- mess_cut_off(me_clean)
mess_cut_off <-  function(data, time = "2020-03-01") {
data %>%
dplyr::mutate(event = dplyr::if_else(date < base::as.Date(time, origin = "1970-01-01"),
"pre", #if before cutoff time
"post")) #if before cutoff time
}
me_cut <- mess_cut_off(me_clean)
me_cut
unique(test$event)
test <- me_clean %>%
dplyr::mutate(event = base::ifelse(date < base::as.Date("2020-03-01", origin = "1970-01-01"),
"pre", #if before cutoff time
"post")) #if before cutoff time
unique(test$event)
time = "2020-03-01"
test <- me_clean %>%
dplyr::mutate(event = base::ifelse(date < base::as.Date(time),
"pre", #if before cutoff time
"post"))
test <- me_clean %>%
dplyr::mutate(event = base::ifelse(date < base::as.Date(time, origin = "1970-01-01"),
"pre", #if before cutoff time
"post"))
unique(test$event)
mess_cut_off <-  function(data, time = "2020-03-01") {
data %>%
dplyr::mutate(event = base::ifelse(time < base::as.Date(time, origin = "1970-01-01"),
"pre", #if before cutoff time
"post")) #if before cutoff time
}
test <- mess_cut_off(me_clean)
unique(test$event)
me_clean
mess_cut_off <-  function(data, time = "2020-03-01") {
data %>%
dplyr::mutate(event = base::ifelse(date < base::as.Date(time, origin = "1970-01-01"),
"pre", #if before cutoff time
"post")) #if before cutoff time
}
test <- mess_cut_off(me_clean, time = "2020-03-01")
unique(test$event)
mess_cut_off <-  function(data, time = "2020-03-01") {
co <- base::as.Date(time, origin = "1970-01-01")
data %>%
dplyr::mutate(event = base::ifelse(date < co,
"pre", #if before cutoff time
"post")) #if before cutoff time
}
test <- mess_cut_off(me_clean, time = "2020-03-01")
unique(test$event)
test$event
summary(test$event)
table(test$event)
t_mess(test)
plot_mess(test)
plot_mess <- function(data) {
timestamp_ms <- value <- event <- vars <- sender <- NULL
event_ts_p =
ggplot2::ggplot(data,
ggplot2::aes(x= timestamp_ms, y = value, fill = event, color = event )) +
ggplot2::geom_col(show.legend = F) +
ggplot2::facet_wrap(ggplot2::vars(sender))
sentiment_hist =
ggplot2::ggplot(data,
ggplot2::aes(value, fill= event, color = event)) +
ggplot2::geom_density(position = "dodge", na.rm = T, alpha = .5) +
ggplot2::facet_wrap(ggplot2::vars(sender))
event_ts_p
sentiment_hist
}
plot_mess(test)
ggplot2::ggplot(test,
ggplot2::aes(x= timestamp_ms, y = value, fill = event, color = event )) +
ggplot2::geom_col(show.legend = F) +
ggplot2::facet_wrap(ggplot2::vars(sender))
test
me_cut <- mess_cut_off(me_clean)
me_cut
unique(me_cut$event)
me_sent <- mess_sentiment(me_cut)
t_mess(me_sent)
t_mess <-  function(data){
event <- value <- NULL
x = data %>%
dplyr::filter(event == "pre") %>%
dplyr::select(value)
y = data %>%
dplyr::filter(event == "post") %>%
dplyr::select(value)
t_test = stats::t.test(x,y)
t_test
}
t_mess(me_sent)
plot_mess(me_sent)
ggplot2::ggplot(me_sent,
ggplot2::aes(x= timestamp_ms, y = value, fill = event, color = event )) +
ggplot2::geom_col(show.legend = F) +
ggplot2::facet_wrap(ggplot2::vars(sender))
alex <- me_sent %>%
filter(sender="Alexander James Robertson")
alex <- me_sent %>%
filter(sender == "Alexander James Robertson")
names(me_sent)
alex <- me_sent[which(me_sent$sender == "Alexander James Robertson")]
alex <- me_sent[,which(me_sent$sender == "Alexander James Robertson")]
alex <- me_sent[which(me_sent$sender == "Alexander James Robertson"),
]
alex
alex$content_unclean[55555]
alex$content_unclean[5555]
alex$content_unclean[5556]
alex$content_unclean[553]
alex$content_unclean[53]
h <- ggplot(alex, aes(x=date, y=hour, color=sender))
h + geom_point(size=1) +
scale_y_continuous(limits = c(0, 24), breaks = (0:12)*2)
h <- ggplot(alex, aes(x=date, y=hour, color=sender))
h + geom_point(size=1) +
scale_y_continuous(limits = c(0, 24), breaks = (0:12)*2)
## Scatter of messages sent by time
h <- ggplot(alex, aes(x=date, y=hour, color=sender))
plot_mess(alex)
ggplot2::ggplot(alex,
ggplot2::aes(x= timestamp_ms, y = value, fill = event, color = event )) +
ggplot2::geom_col(show.legend = F) +
ggplot2::facet_wrap(ggplot2::vars(sender))
min(alex$value)
min(alex$value,na.rm = TRUE)
library(plotly)
ggplotly(ggplot2::ggplot(alex,
ggplot2::aes(x= timestamp_ms, y = value, fill = event, color = event )) +
ggplot2::geom_col(show.legend = F) +
ggplot2::facet_wrap(ggplot2::vars(sender)))
plot_mess <- function(data) {
timestamp_ms <- value <- event <- vars <- sender <- NULL
event_ts_p =
ggplot2::ggplot(data,
ggplot2::aes(x= timestamp_ms, y = value, fill = event, color = event )) +
ggplot2::geom_col(show.legend = F) +
ggplot2::facet_wrap(ggplot2::vars(sender))
sentiment_hist =
ggplot2::ggplot(data,
ggplot2::aes(value, fill= event, color = event)) +
ggplot2::geom_density(position = "dodge", na.rm = T, alpha = .5) +
ggplot2::facet_wrap(ggplot2::vars(sender))
sentiment_hist; event_ts_p
}
plot_mess(me_sent)
document()
rm(list = c("group_sum", "mess_cut_off", "t_mess"))
document()
check()
check()
library(devtools)
install()
library(metamessengr)
mess_selection("C:/Users/meowy/OneDrive/Desktop/fbm_data_subset")
me <- mess_selection("C:/Users/meowy/OneDrive/Desktop/fbm_data_subset")
me <- clean_mess_all(me)
sender_sum(me)
sender_sum <- function(data) {
sender <- sent_to <- count <- NULL
data %>%
dplyr::group_by(sender,sent_to) %>%
dplyr::summarise(count = dplyr::n(),
length = base::sum(length, na.rm = T)) %>%
dplyr::arrange(dplyr::desc(count))
}
sender_sum(me)
group_sum(me)
me_sent <- mess_sentiment(me)
me_sent <- mess_cut_off(me_sent)
me_sent
unique(me_sent$event)
t_mess(me_sent)
t_mess(me_sent[which(me$convo=="Olivia Wang")])
plot_senti_time(me_sent)
plot_senti_time(me_sent, wrap_by = sender)
plot_senti_time <- function(data) {
timestamp_ms <- value <- event <- vars <- sender <- NULL
event_ts_p =
ggplot2::ggplot(data,
ggplot2::aes(x= timestamp_ms, y = value, fill = event, color = event )) +
ggplot2::geom_col(show.legend = F) +
ggplot2::facet_wrap(ggplot2::vars(sender))
event_ts_p
}
plot_senti_time(me_sent)
